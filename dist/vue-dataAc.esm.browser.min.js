/*!
  * vue-dataAc v2.0.0
  * (c) 2020 adminV
  * @license MIT
  */
/*!
  * vue-dataAc v2.0.0
  * (c) 2020 adminV
  * @license MIT
  */
const t={storeVer:"2.0.0",storeInput:"ACINPUT",storePage:"ACPAGE",storeClick:"ACCLIK",storeReqErr:"ACRERR",storeTiming:"ACTIME",storeCodeErr:"ACCERR",storeCustom:"ACCUSTOM",userSha:"vue_ac_userSha",useImgSend:!0,useStorage:!0,maxDays:365,openInput:!0,openCodeErr:!0,openClick:!0,openXhrData:!0,openXhrHock:!0,openPerformance:!0,openPage:!0,selector:"input",acRange:["text","tel","password"],classTag:"isjs-ac",acbLength:2,imageUrl:"http://open.isjs.cn/logStash/push.png",postUrl:"",openReducer:!1,sizeLimit:20,lazyReport:!1};function e(t){return!(0===t&&"0"===t||void 0!==t&&null!=t&&"null"!==t&&""!==t)}function o(t){for(let e in t)return!1;return!0}class i{constructor(i={},s={}){let n=function(t,e){let o,i={};const s=Object.keys(e);for(let n=0;n<s.length;n++)o=s[n],i[o]=void 0!==t[o]?t[o]:e[o];return i}(i,t);!function(t){if(o(t))return;["storeInput","storePage","storeClick","storeReqErr","storeTiming","storeCodeErr","userSha","useImgSend","useStorage","maxDays","openInput","openCodeErr","openClick","openXhrData","openXhrHock","openPerformance","openPage"].map(o=>{e(t[o])}),t.useImgSend?e(t.imageUrl):e(t.postUrl),t.openInput&&(e(t.selector),e(t.acRange)),t.useStorage}(n),this._options=n,this._vue_=s,this._uuid=function(t,e){if(!e)return null;if(t.useStorage)return window.localStorage.getItem(e);{let t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t&&t.length>1?decodeURIComponent(t[2]):null}}(this._options,this._options.userSha),e(this._uuid)&&(this._uuid=function(t=16,e=16){let o,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),s=[];for(o=0;o<t;o++)s[o]=i[0|Math.random()*e];return s.join("")}(),function(t,e,o,i){if(t.useStorage)window.localStorage.setItem(e,o);else{i||(i=t.maxDays);let s=new Date;s.setTime(s.getTime()+24*i*60*6e4),document.cookie=`${e}=${encodeURIComponent(o)};expires=${s.toUTCString()};path=/`}}(this._options,this._options.userSha,this._uuid)),this._acData=[],this._lastRouterStr="",this._pageInTime=0,this._init()}_init(){this._options.openXhrData&&this._initXhrErrAc(),this._options.openPerformance&&this._initPerformance(),this._options.openCodeErr&&this._initCodeErrAc(),this._options.openInput&&this._initInputAc(),this._options.openClick&&this._initClickAc(),this._options.openPage&&this._initPageAc()}_initPageAc(){}_initXhrErrAc(){}_initPerformance(){}_initCodeErrAc(){}_initInputAc(){}_initClickAc(){}postAcData(){if(e(this._acData)||0===this._acData.length)return;let t=JSON.stringify(this._acData);this._options.useImgSend?(new Image).src=`${this._options.imageUrl}?acError=${t}`:function(t={}){let e,o;t.type=(t.type||"GET").toUpperCase(),t.dataType=t.dataType||"json",t.async=t.async||!0,t.data&&(o=t.data),window.XMLHttpRequest?(e=new XMLHttpRequest,e.overrideMimeType&&e.overrideMimeType("text/xml")):e=new ActiveXObject("Microsoft.XMLHTTP"),"GET"===t.type?(e.open("GET",t.url+"?"+o,t.async),e.send(null)):"POST"===t.type&&(e.open("POST",t.url,t.async),e.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o?e.send(o):e.send())}({type:"POST",dataType:"json",contentType:"application/json",data:t,url:this._options.postUrl}),this._acData=[]}_mixinBeforeCreate(){}_mixinMounted(){}_mixinDestroyed(){}_mixinRouterWatch(t={},i={}){let s=t.fullPath||t.path||t.name,n=o(t.params)?t.query:t.params,a=i.fullPath||i.path||i.name,r=o(i.params)?i.query:i.params;this._lastRouterStr!==`${s}-${JSON.stringify(n)}`&&(e(s)||e(a)||(this._lastRouterStr=`${s}-${JSON.stringify(n)}`,this._setAcData(this._options.storePage,{toPath:s,toParams:n,fromPath:a,formParams:r})))}_report(t){}_setAcData(t,e){let o={uuid:this._uuid};switch(t){case this._options.storeInput:break;case this._options.storePage:let{toPath:t,toParams:i,fromPath:s,formParams:n}=e,a=this._pageInTime,r=function(){let t=new Date;return{timeStr:`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()} ${t.getHours()}:${t.getMinutes()}:${t.getSeconds()}`,timeStamp:t.getTime()}}().timeStamp;this._pageInTime=r,o.acData={type:this._options.storePage,fromPath:s,formParams:n,toPath:t,toParams:i,sTme:a,eTme:r};break;case this._options.storeClick:case this._options.storeReqErr:case this._options.storeCodeErr:case this._options.storeCustom:case this._options.storeTiming:}this._acData.push(o),this._options.openReducer?this._options.sizeLimit&&this._acData.length>=this._options.sizeLimit&&this.postAcData():this.postAcData()}}i.install=(t,e)=>function t(e,o,i){t.installed||(t.installed=!0,e.mixin({watch:{$route(t,e){this.$vueDataAc&&this.$vueDataAc._mixinRouterWatch(t,e)}},beforeCreate(){console.log(this)},destroyed(){},mounted(){}}),e.prototype.$vueDataAc=new i(o,e))}(t,e,i),i.version="2.0.0";export default i;