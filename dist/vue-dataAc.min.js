/*!
  * vue-dataAc v2.0.0
  * (c) 2020 adminV
  * @license MIT
  */
/*!
  * vue-dataAc v2.0.0
  * (c) 2020 adminV
  * @license MIT
  */
var t,e;t=this,e=function(){"use strict";var t={storeVer:"2.0.0",storeInput:"ACINPUT",storePage:"ACPAGE",storeClick:"ACCLIK",storeReqErr:"ACRERR",storeTiming:"ACTIME",storeCodeErr:"ACCERR",storeCustom:"ACCUSTOM",storeSourceErr:"ACSCERR",storePrmseErr:"ACPRERR",storeCompErr:"ACCOMP",userSha:"vue_ac_userSha",useImgSend:!0,useStorage:!0,maxDays:365,openInput:!0,openCodeErr:!0,openClick:!0,openXhrData:!0,openXhrHock:!0,openPerformance:!0,openPage:!0,openSourceErr:!0,openPromiseErr:!0,openComponent:!0,selector:"input",acRange:["text","tel","password"],classTag:"isjs-ac",acbLength:2,imageUrl:"http://open.isjs.cn/logStash/push.png",postUrl:"",openReducer:!1,sizeLimit:20,lifeReport:!1,manualReport:!1};function e(t){return!(0===t&&"0"===t||void 0!==t&&null!=t&&"null"!==t&&""!==t)}function o(t){for(var e in t)return!1;return!0}function r(){var t=new Date;return{timeStr:t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds(),timeStamp:t.getTime()}}var i=function(r,i){void 0===r&&(r={}),void 0===i&&(i={});var n=function(t,e){for(var o,r={},i=Object.keys(e),n=0;n<i.length;n++)r[o=i[n]]=void 0!==t[o]?t[o]:e[o];return r}(r,t);!function(t){o(t)||(["storeInput","storePage","storeClick","storeReqErr","storeTiming","storeCodeErr","userSha","useImgSend","useStorage","maxDays","openInput","openCodeErr","openClick","openXhrData","openXhrHock","openPerformance","openPage"].map((function(o){e(t[o])})),t.useImgSend?e(t.imageUrl):e(t.postUrl),t.openInput&&(e(t.selector),e(t.acRange)),t.useStorage)}(n),this._options=n,this._vue_=i,this._uuid=function(t,e){if(!e)return null;if(t.useStorage)return window.localStorage.getItem(e);var o=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return o&&o.length>1?decodeURIComponent(o[2]):null}(this._options,this._options.userSha),e(this._uuid)&&(this._uuid=function(t,e){void 0===t&&(t=16),void 0===e&&(e=16);var o,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=[];for(o=0;o<t;o++)i[o]=r[0|Math.random()*e];return i.join("")}(),function(t,e,o,r){if(t.useStorage)window.localStorage.setItem(e,o);else{r||(r=t.maxDays);var i=new Date;i.setTime(i.getTime()+24*r*60*6e4),document.cookie=e+"="+encodeURIComponent(o)+";expires="+i.toUTCString()+";path=/"}}(this._options,this._options.userSha,this._uuid)),this._acData=[],this._lastRouterStr="",this._pageInTime=0,this._init()};return i.prototype._init=function(){this._options.openCodeErr&&this._initCodeErrAc(),this._options.openSourceErr&&this._initSourceErrAc(),this._options.openPromiseErr&&this._initPromiseErrAc(),this._options.openXhrData&&this._initXhrErrAc(),this._options.openPerformance&&this._initPerformance(),this._options.openInput&&this._initInputAc(),this._options.openClick&&this._initClickAc()},i.prototype._initPageAc=function(){},i.prototype._initXhrErrAc=function(){},i.prototype._initPerformance=function(){},i.prototype._initCodeErrAc=function(){var t=arguments,o=this;window.onerror=function(r,i,n,s,a){if(e(i)&&"Script error."===r)return!1;var c={msg:r,line:n,col:s};c.col=s||window.event&&window.event.errorCharacter||0,setTimeout((function(){if(a&&a.stack)c.err=a.stack.toString();else if(t.callee){for(var e=[],r=t.callee.caller,i=3;r&&--i>0&&(e.push(r.toString()),r!==r.caller);)r=r.caller;e=e.join(","),c.err=e}else c.err="script err";o._setAcData(o._options.storeCodeErr,c)}),0)}},i.prototype._initSourceErrAc=function(){var t=this;window.addEventListener("error",(function(o){if("[object Event]"===[].toString.call(o,o)){var r=o.target||o.srcElement||o.originalTarget||{},i=r.tagName,n=r.outerHTML;void 0===n&&(n="");var s=r.href,a=r.src,c=r.currentSrc,p=r.localName,u=s||a;if("IMG"===(i=i||p)&&!e(r.onerror))return!1;n&&n.length>200&&(n=n.slice(0,200)),t._setAcData(t._options.storeSourceErr,{tagName:i,outerHTML:n,resourceUri:u,currentSrc:c})}}))},i.prototype._initPromiseErrAc=function(){var t=this;window.addEventListener("unhandledrejection",(function(e){t._setAcData(t._options.storePrmseErr,{reason:e.reason||"unknown"}),e.preventDefault()}))},i.prototype._initInputAc=function(){},i.prototype._initClickAc=function(){},i.prototype.setCustomAc=function(t){var e=t.cusKey;void 0===e&&(e="custom");var o=t.cusVal;void 0===o&&(o=""),this._setAcData(this._options.storeCustom,{cusKey:e,cusVal:o})},i.prototype.postAcData=function(){if(!e(this._acData)&&0!==this._acData.length){var t,o,r,i=JSON.stringify(this._acData);this._options.useImgSend?(new Image).src=this._options.imageUrl+"?acError="+i:(void 0===(t={type:"POST",dataType:"json",contentType:"application/json",data:i,url:this._options.postUrl})&&(t={}),t.type=(t.type||"GET").toUpperCase(),t.dataType=t.dataType||"json",t.async=t.async||!0,t.data&&(r=t.data),window.XMLHttpRequest?(o=new XMLHttpRequest).overrideMimeType&&o.overrideMimeType("text/xml"):o=new ActiveXObject("Microsoft.XMLHTTP"),"GET"===t.type?(o.open("GET",t.url+"?"+r,t.async),o.send(null)):"POST"===t.type&&(o.open("POST",t.url,t.async),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r?o.send(r):o.send())),this._acData=[]}},i.prototype._mixinBeforeCreate=function(){},i.prototype._mixinMounted=function(){},i.prototype._mixinDestroyed=function(){},i.prototype._mixinRouterWatch=function(t,r){void 0===t&&(t={}),void 0===r&&(r={});var i=t.fullPath||t.path||t.name,n=o(t.params)?t.query:t.params,s=r.fullPath||r.path||r.name,a=o(r.params)?r.query:r.params;this._lastRouterStr!==i+"-"+JSON.stringify(n)&&(e(i)||e(s)||(this._lastRouterStr=i+"-"+JSON.stringify(n),this._setAcData(this._options.storePage,{toPath:i,toParams:n,fromPath:s,formParams:a})))},i.prototype._report=function(t){},i.prototype._setAcData=function(t,e){var o={uuid:this._uuid};switch(t){case this._options.storeInput:break;case this._options.storePage:var i=e.toPath,n=e.toParams,s=e.fromPath,a=e.formParams,c=this._pageInTime,p=r().timeStamp;this._pageInTime=p,o.acData={type:this._options.storePage,fromPath:s,formParams:a,toPath:i,toParams:n,sTme:c,eTme:p};break;case this._options.storeClick:case this._options.storeReqErr:break;case this._options.storeCodeErr:var u=e.msg,h=e.line,m=e.col,l=e.err;o.acData={type:this._options.storeCodeErr,path:window.location.href,sTme:r().timeStamp,ua:navigator.userAgent,msg:u,line:h,col:m,err:l};break;case this._options.storeSourceErr:var _=e.tagName,d=e.outerHTML,f=e.resourceUri,g=e.currentSrc;o.acData={type:this._options.storeSourceErr,path:window.location.href,sTme:r().timeStamp,ua:navigator.userAgent,fileName:g,resourceUri:f,tagName:_,outerHTML:d};break;case this._options.storePrmseErr:var v=e.reason;o.acData={type:this._options.storePrmseErr,path:window.location.href,sTme:r().timeStamp,ua:navigator.userAgent,reason:v};break;case this._options.storeCustom:var y=e.cusKey,S=e.cusVal;o.acData={type:this._options.storeCustom,path:window.location.href,sTme:r().timeStamp,ua:navigator.userAgent,cusKey:y,cusVal:S};break;case this._options.storeTiming:}this._acData.push(o),this._options.openReducer?!this._options.manualReport&&this._options.sizeLimit&&this._acData.length>=this._options.sizeLimit&&this.postAcData():this.postAcData()},i.install=function(t,e){return function t(e,o,r){t.installed||(t.installed=!0,e.mixin({watch:{$route:function(t,e){this.$vueDataAc&&this.$vueDataAc._mixinRouterWatch(t,e)}},beforeCreate:function(){console.log(this)},destroyed:function(){},mounted:function(){}}),e.prototype.$vueDataAc=new r(o,e))}(t,e,i)},i.version="2.0.0",i},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).VueDataAc=e();